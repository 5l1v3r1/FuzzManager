{% extends 'layouts/layout_1_column_full_width.html' %}
{% load url from future %}
{% load extratags %}

{% block 1 %}
<div class="panel">
	<div class="body notitle">
		{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
		<div class="field">
			 <span class="label">Status:</span>
			 	<span>
					{% if entry.bucket %}
						Assigned to bucket <a href="{% url 'crashmanager:sigview' entry.bucket.pk %}">{{ entry.bucket.pk }}</a>.
						{% if entry.bucket.bug %}
							Reported as <a href="{{ entry.bucket.bug.externalType.urlTemplate|varformat:entry.bucket.bug.externalId }}">bug {{ entry.bucket.bug.externalId }}</a>.
						{% else %}
							Unreported, <a href="{% url 'crashmanager:createbug' entry.pk %}">file a bug</a>.
						{% endif %}
					{% else %}
						Not assigned to any bucket. <a href="{% url 'crashmanager:signew' %}?crashid={{ entry.pk }}">Create new</a>
					{% endif %}
				</span>
		</div>

		<div class="field">
			<span class="label">Created: </span><span class="code">{{ entry.created|date:"r" }}</span>
			<span class="label">by Client: </span><span class="code">{{ entry.client.name|escape }}</span>
		</div>

		
		<form action="{% url 'crashmanager:crashedit' entry.pk %}" method="post">
		{% csrf_token %}

		<div class="field">
			<span class="label">Short Signature: </span><span class="code">{{ entry.shortSignature|escape }}</span>
		</div>

		<div class="field">
			<span class="label">Product: </span><span class="code">{{ entry.product.name }}</span>
		</div>

		<div class="field">
			<span class="label">Version: </span><span class="code">{{ entry.product.version }}</span>
		</div>
		
		<div class="field">
			<span class="label">Platform: </span><span class="code">{{ entry.platform.name }}</span>
		</div>

		<div class="field">
			<span class="label">OS: </span><span class="code">{{ entry.os.name }}</span>
		</div>

		<div class="field">
			<span class="label">Reported by Tool: </span><span class="code">{{ entry.tool.name }}</span>
		</div>

		<div class="field">
			<label class="label" for="id_rawStdout">Data on stdout:</label><br/>
			<textarea id="id_rawStdout" name="rawStdout">{{ entry.rawStdout }}</textarea>
		</div>

		<div class="field">
			<label class="label" for="id_rawStderr">Data on stderr:</label><br/>
			<textarea id="id_rawStderr" name="rawStderr">{{ entry.rawStderr }}</textarea>
		</div>

		<div class="field">
			<label class="label" for="id_rawCrashData">Additional Crash Data:</label><br/>
			<textarea id="id_rawCrashData" name="rawCrashData">{{ entry.rawCrashData }}</textarea>
		</div>

		<div class="field">
			<label class="label" for="id_testcase">Testcase:</label><br/>

			{% if entry.testcase.isBinary %}
			<textarea id="id_testcase" name="testcase">(binary)</textarea>
			{% else %}
			<textarea id="id_testcase" name="testcase">{{ entry.testcase.content }}</textarea>
			{% endif %}
		</div>

		<div class="field">
			<label class="label" for="id_args">Command line arguments:</label><br/>
			<textarea id="id_args" name="args">{{ entry.argsList|linejoin }}</textarea>
		</div>

		<div class="field">
			<label class="label" for="id_env">Environment variable:</label><br/>
			<textarea id="id_env" name="env">{{ entry.envList|linejoin }}</textarea>
		</div>

		<div class="field">
			<label class="label" for="id_metadata">Metadata:</label><br/>
			<textarea id="id_metadata" name="metadata">{{ entry.metadataList|linejoin }}</textarea>
		</div>

		<input type="submit" name="submit_save" value="Save" />
		</form>
        </div>
</div>
{% endblock 1 %}
