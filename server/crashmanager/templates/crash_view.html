{% extends 'layouts/layout_1_column_full_width.html' %}
{% load url from future %}
{% load extratags %}

{% block 1 %}
<div class="panel">
	<div class="body notitle">
		<div class="field">
			 <strong>Status:</strong>
			 	<span>
					{% if entry.bucket %}
						Assigned to bucket <a href="{% url 'crashmanager:sigview' entry.bucket.pk %}">{{ entry.bucket.pk }}</a>.
						{% if entry.bucket.bug %}
							Reported as <a href="{{ entry.bucket.bug.externalType.urlTemplate|varformat:entry.bucket.bug.externalId }}">bug {{ entry.bucket.bug.externalId }}</a>.
						{% else %}
							Unreported, <a href="{% url 'crashmanager:createbug' entry.pk %}">file a bug</a> or 
							<a href="{% url 'crashmanager:siglink' entry.bucket.pk %}">assign an existing bug</a>.
						{% endif %}
					{% else %}
						Not assigned to any bucket. <a href="{% url 'crashmanager:signew' %}?crashid={{ entry.pk }}">Create new</a> or
						<a href="{% url 'crashmanager:findsigs' entry.pk %}">Search bucket</a>
					{% endif %}
				</span>
		</div>

		<div class="field">
			<strong>Actions:</strong>
			<a href="{% url 'crashmanager:crashedit' entry.pk %}">Edit</a>
			-
			<a href="{% url 'crashmanager:crashdel' entry.pk %}">Delete</a>
		</div>

		<div class="field">
			<strong>Created: </strong><span class="code">{{ entry.created|date:"r" }}</span>
			<strong>by Client: </strong><span class="code">{{ entry.client.name|escape }}</span>
		</div>

		<div class="field">
			<strong>Short Signature: </strong><span class="code">{{ entry.shortSignature|escape }}</span>
		</div>

		<div class="field">
			<strong>Product: </strong><span class="code">{{ entry.product.name }}</span>
		</div>

		<div class="field">
			<strong>Version: </strong><span class="code">{{ entry.product.version }}</span>
		</div>
		
		<div class="field">
			<strong>Platform: </strong><span class="code">{{ entry.platform.name }}</span>
		</div>

		<div class="field">
			<strong>OS: </strong><span class="code">{{ entry.os.name }}</span>
		</div>
		
		<div class="field">
			<strong>Reported by Tool: </strong><span class="code">{{ entry.tool.name }}</span>
		</div>

		{% if entry.rawStdout %}
		<div class="field">
			<strong>Data on stdout:</strong><br/>
			<pre class="code"><code>{{ entry.rawStdout }}</code></pre>
		</div>
		{% endif %}

		{% if entry.rawStderr %}
		<div class="field">
			<strong>Data on stderr:</strong><br/>
			<pre class="code"><code>{{ entry.rawStderr }}</code></pre>
		</div>
		{% endif %}

		{% if entry.rawCrashData %}
		<div class="field">
			<strong>Additional Crash Data:</strong><br/>
			<pre class="code"><code>{{ entry.rawCrashData }}</code></pre>
		</div>
		{% endif %}

		{% if entry.testcase %}
		<div class="field">
			<strong>Testcase:</strong><br/>
			{% if entry.testcase.isBinary %}
			<a href="{% url 'crashmanager:download' entry.testcase.test.name|basename %}">Download</a>
			{% else %}
			<pre class="code"><code>{{ entry.testcase.content }}</code></pre>
			{% endif %}
		</div>
		{% endif %}

		{% if entry.argsList %}
		<div class="field">
			<strong>Command line arguments: </strong>
			{% for arg in entry.argsList %}
			<span class="code">{{ arg }}</span>
			{% endfor %}
		</div>
		{% endif %}

		{% if entry.envList %}
		<div class="field">
			<strong>Environment variables: </strong>
			{% for arg in entry.envList %}
			<div class="code">{{ arg }}</div>
			{% endfor %}
		</div>
		{% endif %}

		{% if entry.metadataList %}
		<div class="field">
			<strong>Metadata: </strong>
			{% for arg in entry.metadataList %}
			<div class="code">{{ arg }}</div>
			{% endfor %}
		</div>
		{% endif %}
        </div>
</div>
{% endblock 1 %}
